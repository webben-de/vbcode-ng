import{a as Oe}from"./chunk-DRR54RBR.js";import{b as Ve}from"./chunk-X36R26KF.js";import{a as Be}from"./chunk-AV5ZQB5U.js";import{a as Le}from"./chunk-NCBZGK5Q.js";import{a as K,b as Z}from"./chunk-P6AMAEKG.js";import{a as Pe,b as Ie}from"./chunk-XSJT75Y5.js";import{o as j,q as ke,v as $,w as z}from"./chunk-CNOLVGQB.js";import{b as xe,d as U,f as D,g as ye,h as W,j as s,l as ge,m as we,o as Se,p as Fe,q as Ee,s as be,u as H,v as q}from"./chunk-VZJ7TN34.js";import"./chunk-3ACIU7HM.js";import{e as _e}from"./chunk-LERSMEHN.js";import{b as de,c as ue,f as ve}from"./chunk-QUDDSHFB.js";import{a as he}from"./chunk-ZNAIGONW.js";import{a as Me}from"./chunk-42BQEJLT.js";import{R as N,X as Te}from"./chunk-SMK4RA2U.js";import{C as Ce,D as Ge,i as me,k as pe,l as se,p as ce,y as fe}from"./chunk-WYJAB3JE.js";import{Ac as ie,Bb as y,Cc as c,Dc as d,Ea as T,Ec as ne,Fa as M,Fb as f,Fc as ae,Ga as B,Kb as g,Lb as w,Nb as S,Ob as F,Pb as r,Qa as k,Qb as i,Rb as _,Vb as V,Vc as re,Yb as P,_b as E,hb as Y,ic as O,id as oe,kb as n,kc as m,lc as v,mc as h,nc as ee,oa as x,od as le,sc as te,ua as I,wc as R,xa as L,xc as A,zc as Q}from"./chunk-ME47VETO.js";import"./chunk-SECEFDB3.js";import{i as G}from"./chunk-GK2WYAVW.js";var Re=(()=>{let t=class t{transform(a,l){return a?a.filter(p=>p.id!==l):null}};t.\u0275fac=function(l){return new(l||t)},t.\u0275pipe=L({name:"pristineEvent",type:t,pure:!0,standalone:!0});let e=t;return e})();var Ae=(()=>{let t=class t{transform(a,l,p){if(!a)return[];let u=Object.values(l).map(b=>b.value),C=a.filter(b=>!u.includes(b?.id))||[],J=a.find(b=>b?.id===l[p].value);return[...C,J]}};t.\u0275fac=function(l){return new(l||t)},t.\u0275pipe=L({name:"pristine",type:t,pure:!1,standalone:!0});let e=t;return e})();function ze(e,t){if(e&1&&(r(0,"mat-option",1),m(1),i()),e&2){let o=t.$implicit;f("value",o==null?null:o.id),n(),ee(" ",o==null?null:o.trikot," - ",o==null?null:o.name," ")}}var Ne=(()=>{let t=class t{constructor(){this.index=k.required(),this.home_team_start_rotation=k.required(),this.playerList=k.required(),this.attendees=k.required(),this.attendeesPlayer=re(()=>this.attendees()?.map(a=>this.playerList().find(l=>l.id===a)))}};t.\u0275fac=function(l){return new(l||t)},t.\u0275cmp=I({type:t,selectors:[["app-single-roation-form-control"]],hostAttrs:[1,"flex","flex-col"],inputs:{index:[1,"index"],home_team_start_rotation:[1,"home_team_start_rotation"],playerList:[1,"playerList"],attendees:[1,"attendees"]},standalone:!0,features:[R],decls:8,vars:6,consts:[[3,"formControl"],[3,"value"]],template:function(l,p){if(l&1&&(r(0,"mat-form-field")(1,"mat-label"),m(2),i(),te(3),r(4,"mat-select",0),S(5,ze,2,3,"mat-option",1,w),c(7,"pristine"),i()()),l&2){n(2),v(p.index());let u=p.home_team_start_rotation().controls;n(2),f("formControl",u[p.index()]),n(),F(ae(7,2,p.attendeesPlayer(),u,p.index()))}},dependencies:[z,$,j,Z,K,N,H,D,q,Se,Ae],encapsulation:2});let e=t;return e})();var Ke=()=>["Private","Public"],Ue=(e,t)=>[e,t],De=()=>[4,3,2,5,6,1],Ze=(e,t,o)=>[e,t,o];function Je(e,t){e&1&&(m(0),c(1,"transloco")),e&2&&h(" ",d(1,1,"create-a-new-game")," ")}function Qe(e,t){e&1&&(m(0),c(1,"transloco")),e&2&&h(" ",d(1,1,"edit-a-game")," ")}function We(e,t){if(e&1&&(r(0,"mat-option",18),m(1),i()),e&2){let o=t.$implicit;f("value",o),n(),h(" ",o," ")}}function Xe(e,t){if(e&1&&(r(0,"mat-option",18),m(1),i()),e&2){let o=t.$implicit;f("value",o.id),n(),h(" ",o.name," ")}}function Ye(e,t){if(e&1&&_(0,"app-attendees-select-form-control",20),e&2){let o=E();f("playerList",o.playerList)("attendees",o.createGameForm.controls.attendees)}}function et(e,t){if(e&1&&_(0,"app-single-roation-form-control",32),e&2){let o=t.$implicit,a=E(2);f("playerList",a.playerList)("index",o)("attendees",a.createGameForm.controls.attendees.value)("home_team_start_rotation",a.createGameForm.controls.home_team_start_rotation)}}function tt(e,t){e&1&&(r(0,"span",30),m(1),c(2,"transloco"),i(),r(3,"p"),m(4,"Bezieht sich nur auf Satz 1 solange diese noch nicht Satzweise abgepasst werden kann"),i(),r(5,"div",31),S(6,et,1,4,"app-single-roation-form-control",32,w),i()),e&2&&(n(),v(d(2,1,"start-rotation")),n(5),F(A(3,De)))}function it(e,t){if(e&1&&(r(0,"mat-option",18),m(1),i()),e&2){let o=t.$implicit;f("value",o.id),n(),h(" ",o.name," ")}}function nt(e,t){if(e&1&&_(0,"app-single-roation-form-control",33),e&2){let o=t.$implicit,a=E(2);f("playerList",a.playerList)("attendees",a.createGameForm.controls.attendees.value)("index",o)("home_team_start_rotation",a.createGameForm.controls.away_team_start_rotation)}}function at(e,t){e&1&&(r(0,"span",30),m(1),c(2,"transloco"),i(),r(3,"div",31),S(4,nt,1,4,"app-single-roation-form-control",33,w),i()),e&2&&(n(),v(d(2,1,"start-rotation")),n(3),F(A(3,De)))}function rt(e,t){e&1&&(B(),r(0,"svg",42)(1,"title"),m(2,"youtube"),i(),_(3,"path",44),i())}function ot(e,t){e&1&&(B(),r(0,"svg",43)(1,"title"),m(2,"video-outline"),i(),_(3,"path",45),i())}function lt(e,t){if(e&1&&(r(0,"li",40)(1,"a",41),y(2,rt,4,0,":svg:svg",42)(3,ot,4,0,":svg:svg",43),i()()),e&2){let o=t.$implicit;n(),f("href",o,Y),n(),g(o.includes("youtube")?2:3)}}function mt(e,t){if(e&1){let o=V();r(0,"div",34)(1,"div",14)(2,"mat-form-field",8)(3,"mat-label"),m(4),c(5,"transloco"),i(),_(6,"input",35),i()(),r(7,"div",14)(8,"mat-form-field",8)(9,"mat-label"),m(10),c(11,"transloco"),i(),_(12,"input",36),i()()(),r(13,"div",37)(14,"input",38,4),P("keydown.enter",function(l){T(o);let p=O(15),u=E();return M(u.addMediaLink(l,p))}),i(),r(16,"ul",39),S(17,lt,4,2,"li",40,w),i()()}if(e&2){let o=E();n(4),h("",d(5,2,"result-home")," "),n(6),h("",d(11,4,"result-away")," "),n(7),F(o.createGameForm.controls.media_links.value)}}function pt(e,t){if(e&1){let o=V();r(0,"a",29),m(1),c(2,"transloco"),i(),r(3,"button",46),P("click",function(){T(o);let l=E();return M(l.deleteGame())}),B(),r(4,"svg",47),_(5,"path",48),i(),m(6),c(7,"transloco"),i()}if(e&2){let o=E();f("routerLink",ie(7,Ze,o.ROUTES.root,o.ROUTES.roationPlaner,o.createGameForm.controls.id.value)),n(),v(d(2,3,"See Rotation Preview")),n(5),h(" ",d(7,5,"delete-game")," ")}}var Jt=(()=>{let t=class t{constructor(){this.ROUTES=he,this.route=x(me),this.router=x(pe),this.snack=x(Le),this.eventsService=x(Me),this.supabase=x(Ge),this.playerService=x(Te),this.teamService=x(Be),this.session=fe(Ce.session),this.teams=[],this.players=this.playerService.getPlayers(),this.playerList=[],this.createGameForm=new W({id:new s(void 0),title:new s("",U.required),date:new s(new Date,U.required),media_links:new s([""]),attendees:new s([]),result_home:new s(void 0),result_away:new s(void 0),home_team:new s(void 0),home_team_start_rotation:new W({1:new s(null),2:new s(null),3:new s(null),4:new s(null),5:new s(null),6:new s(null)}),away_team_start_rotation:new be([new s(null),new s(null),new s(null),new s(null),new s(null),new s(null)]),away_team:new s(void 0),owner:new s(this.session()?.user.id||"",U.required),shared_with:new s([]),visibility:new s("Private")})}addMediaLink(a,l){a.preventDefault();let u=a.target?.value;if(!u)return;let C=this.createGameForm.controls.media_links.value;C&&C.length>0?this.createGameForm.controls.media_links.setValue([...C,u]):this.createGameForm.controls.media_links.setValue([u]),l.value=""}createGame(){return G(this,null,function*(){let a=this.createGameForm.value;try{yield this.eventsService.createEvent(a),this.snack.open("Event create","open",{duration:5e3}).onAction().subscribe(()=>{})}catch(l){this.snack.open("Error creating Event:"+l,"OK",{duration:2e3})}})}deleteGame(){return G(this,null,function*(){let a=this.createGameForm.controls.id.value;if(!(!a||!confirm("M\xF6chten Sie dieses Spiel wirklich l\xF6schen? Diese Aktion kann nicht r\xFCckg\xE4ngig gemacht werden.")))try{yield this.eventsService.deleteEvent(a),this.snack.open("Spiel erfolgreich gel\xF6scht","OK",{duration:3e3}),this.router.navigate([this.ROUTES.root,this.ROUTES.games])}catch(p){this.snack.open("Fehler beim L\xF6schen des Spiels: "+p,"OK",{duration:3e3})}})}OnHomeTeamChange(a){return G(this,null,function*(){if(!a)return;let l=yield this.teamService.getTeam(a);this.playerList=yield this.playerService.getPlayerList(l.players)})}ngOnInit(){return G(this,null,function*(){this.route.data.subscribe(a=>{a.game&&this.createGameForm.patchValue(a.game);let l=this.createGameForm.controls.home_team.value;l&&this.OnHomeTeamChange(l)}),this.teams=yield this.teamService.getTeams()})}};t.\u0275fac=function(l){return new(l||t)},t.\u0275cmp=I({type:t,selectors:[["app-create-game-page"]],standalone:!0,features:[R],decls:69,vars:51,consts:[["form",""],["homeTeam",""],["awayTeam",""],["eventFinished",""],["inMedia",""],[1,"flex","flex-col","items-start","gap-8","h-full","p-8"],[1,"text-2xl","font-bold"],[1,"flex","flex-col","w-full",3,"submit","formGroup"],[1,"w-full"],["matInput","","formControlName","title"],[1,"flex","justify-between"],[1,"w-1/3"],["formControlName","visibility"],[3,"value",4,"ngFor","ngForOf"],[1,"w-1/2"],["matInput","","type","date","formControlName","date"],[1,"text-lg"],["formControlName","home_team",3,"valueChange"],[3,"value"],[3,"routerLink"],[3,"playerList","attendees"],[1,"my-2"],[1,""],["formControlName","away_team"],[1,"label","cursor-pointer"],[1,"label-text"],["type","checkbox",1,"toggle"],[1,"btn",3,"type"],[1,"flex","flex-col","gap-2"],[1,"btn","btn-outline","btn-secondary",3,"routerLink"],[1,"text-md"],[1,"grid","grid-cols-3"],[3,"playerList","index","attendees","home_team_start_rotation"],[3,"playerList","attendees","index","home_team_start_rotation"],[1,"flex","gap-2","w-full"],["matInput","","type","number","formControlName","result_home"],["matInput","","type","number","formControlName","result_away"],[1,"flex","flex-col"],["type","text","placeholder","Enter link here",1,"input","input-bordered","input-primary","w-full","max-w-xs",3,"keydown.enter"],[1,"flex","gap-2","h-8","my-4"],[1,"flex"],["target","_blank",1,"btn","btn-xs","w-12","h-12",3,"href"],["width","48","height","48"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M10,15L15.19,12L10,9V15M21.56,7.17C21.69,7.64 21.78,8.27 21.84,9.07C21.91,9.87 21.94,10.56 21.94,11.16L22,12C22,14.19 21.84,15.8 21.56,16.83C21.31,17.73 20.73,18.31 19.83,18.56C19.36,18.69 18.5,18.78 17.18,18.84C15.88,18.91 14.69,18.94 13.59,18.94L12,19C7.81,19 5.2,18.84 4.17,18.56C3.27,18.31 2.69,17.73 2.44,16.83C2.31,16.36 2.22,15.73 2.16,14.93C2.09,14.13 2.06,13.44 2.06,12.84L2,12C2,9.81 2.16,8.2 2.44,7.17C2.69,6.27 3.27,5.69 4.17,5.44C4.64,5.31 5.5,5.22 6.82,5.16C8.12,5.09 9.31,5.06 10.41,5.06L12,5C16.19,5 18.8,5.16 19.83,5.44C20.73,5.69 21.31,6.27 21.56,7.17Z",1,"fill-[#FF0000]"],["d","M15,8V16H5V8H15M16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5V7A1,1 0 0,0 16,6Z",1,"fill-secondary"],["type","button",1,"btn","btn-outline","btn-error",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"]],template:function(l,p){if(l&1){let u=V();r(0,"div",5)(1,"span",6),y(2,Je,2,3)(3,Qe,2,3),i(),r(4,"form",7,0),P("submit",function(){return T(u),M(p.createGame())}),r(6,"mat-form-field",8)(7,"mat-label"),m(8),c(9,"transloco"),i(),_(10,"input",9),i(),r(11,"div",10)(12,"mat-form-field",11)(13,"mat-label"),m(14),c(15,"transloco"),i(),r(16,"mat-select",12),y(17,We,2,2,"mat-option",13),i()(),r(18,"mat-form-field",14)(19,"mat-label"),m(20),c(21,"transloco"),i(),_(22,"input",15),i()(),_(23,"hr"),r(24,"span",16),m(25),c(26,"transloco"),i(),r(27,"mat-form-field",8)(28,"mat-label"),m(29),c(30,"transloco"),i(),r(31,"mat-select",17,1),P("valueChange",function(J){return T(u),M(p.OnHomeTeamChange(J))}),S(33,Xe,2,2,"mat-option",18,w),i(),r(35,"mat-hint")(36,"a",19),m(37),c(38,"transloco"),i()()(),y(39,Ye,1,2,"app-attendees-select-form-control",20)(40,tt,8,4),_(41,"hr",21),r(42,"div",22)(43,"mat-form-field",8)(44,"mat-label"),m(45),c(46,"transloco"),i(),r(47,"mat-select",23,2),S(49,it,2,2,"mat-option",18,w),c(51,"pristineEvent"),i()(),y(52,at,6,4),i(),r(53,"label",24)(54,"span",25),m(55),c(56,"transloco"),i(),_(57,"input",26,3),i(),y(59,mt,19,6),r(60,"button",27),m(61),c(62,"transloco"),i()(),_(63,"hr"),r(64,"p",28)(65,"a",29),m(66),c(67,"transloco"),i(),y(68,pt,8,11),i()()}if(l&2){let u=O(32),C=O(48);n(2),g(p.createGameForm.controls.id.value?3:2),n(2),f("formGroup",p.createGameForm),n(4),v(d(9,21,"title")),n(6),v(d(15,23,"visibility")),n(3),f("ngForOf",A(44,Ke)),n(3),v(d(21,25,"date")),n(5),v(d(26,27,"home")),n(4),v(d(30,29,"home-team")),n(4),F(p.teams),n(3),f("routerLink",Q(45,Ue,p.ROUTES.root+p.ROUTES.teams,u.value)),n(),h(" ",d(38,31,"edit-this-team")," "),n(2),g(p.createGameForm.controls.home_team.valid?39:-1),n(),g(u.value?40:-1),n(5),v(d(46,33,"away-team")),n(4),F(ne(51,35,p.teams,u.value)),n(3),g(C.value?52:-1),n(3),v(d(56,38,"event-finished")),n(4),g(59),n(),f("type","submit"),n(),v(d(62,40,"submit")),n(4),f("routerLink",Q(48,Ue,p.ROUTES.root,p.ROUTES.games)),n(),v(d(67,42,"see-all-your-games-here")),n(2),g(p.createGameForm.controls.id.value?68:-1)}},dependencies:[z,$,j,ke,_e,Ie,Pe,H,ge,xe,we,D,ye,q,Fe,Ee,Ve,Z,K,N,ve,le,oe,ce,se,ue,de,Ne,Re,Oe],encapsulation:2});let e=t;return e})();export{Jt as CreateGamePageComponent};
