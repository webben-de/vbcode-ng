import{a as At,b as Pt}from"./chunk-JLRSTYEO.js";import{a as wt}from"./chunk-KM5RK4ZX.js";import{a as Ct,b as Vt}from"./chunk-IFOM4GZ5.js";import{a as St,e as Mt,f as Et}from"./chunk-2635ERCO.js";import{b as _t,f as pt,k as mt,n as vt,t as ft,u as gt}from"./chunk-24KTCTAN.js";import"./chunk-3ACIU7HM.js";import{a as Wt}from"./chunk-BCCPXHBQ.js";import"./chunk-2WGW7YKY.js";import{b as dt,c as ht,e as yt,f as Rt}from"./chunk-QIFNKBCP.js";import{a as N}from"./chunk-ZNAIGONW.js";import{a as Tt}from"./chunk-NMJ7OOBR.js";import{H as kt,Q as It,W as xt,a as bt}from"./chunk-TS2TU6VR.js";import{C as ut,e as nt,f as at,i as rt,k as B,l as ot,p as lt,y as ct}from"./chunk-S6T5735P.js";import{Ab as S,B as Z,Bc as p,Cc as m,Da as x,Ea as y,Fb as u,Hb as O,Kb as M,Lb as V,Nb as A,Ob as P,Pa as R,Pb as r,Qb as o,Rb as v,Vb as L,Yb as b,_b as f,ba as Y,cc as W,dc as F,ec as X,ha as K,hc as j,ia as J,ic as D,jb as a,jc as h,kc as T,kd as st,lc as E,mc as z,na as _,oc as H,od as U,pc as Q,qc as $,rc as et,ta as I,ua as tt,vc as w,yc as it}from"./chunk-PRUKLSZG.js";import"./chunk-SECEFDB3.js";import{a as k,b as G,f as Lt,i as g}from"./chunk-GK2WYAVW.js";var Dt=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=tt({type:i}),i.\u0275inj=J({imports:[kt,It]});let s=i;return s})();var C=Lt(Wt());var Ft={title:"App Title",description:"App description",author:"Daniil Baunov",keywords:["Angular","meta tags","Angular Universal"],type:"website"},Ut=(()=>{let i=class i{constructor(){this.meta=_(nt),this.titleService=_(at),this.router=_(B)}updateMetadata(e,t=!0){let n=k(k({},Ft),e),c=this.generateMetaDefinitions(n);this.meta.addTags([...c,{name:"robots",content:t?"index, follow":"noindex"},{name:"viewport",content:"width=device-width, initial-scale=1"},{"http-equiv":"Content-Type",content:"text/html; charset=utf-8"}]),this.titleService.setTitle(n.title)}generateMetaDefinitions(e){return[{name:"title",content:e.title},{property:"og:title",content:e.title},{name:"description",content:e.description},{property:"og:description",content:e.description},{name:"author",content:e.author},{property:"og:author",content:e.author},{name:"keywords",content:e.keywords.join(", ")},{property:"og:type",content:e.type}]}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=K({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var Bt=(()=>{let i=class i{constructor(){this.currentRotation=R.required(),this.index=R.required(),this.toggleTrikot=R.required(),this.roatedPlayer=R.required(),this.rotationIndexMap=new Map().set(1,"4").set(2,"3").set(3,"2").set(4,"5").set(5,"6").set(6,"1"),this.rotationMap=new Map().set("1",new Map().set(1,4).set(2,3).set(3,2).set(4,5).set(5,6).set(6,1)).set("2",new Map().set(1,5).set(2,4).set(3,3).set(4,6).set(5,1).set(6,2)).set("3",new Map().set(1,6).set(2,5).set(3,4).set(4,1).set(5,2).set(6,3)).set("4",new Map().set(1,1).set(2,6).set(3,5).set(4,2).set(5,3).set(6,4)).set("5",new Map().set(1,2).set(2,1).set(3,6).set(4,3).set(5,4).set(6,5)).set("6",new Map().set(1,3).set(2,2).set(3,1).set(4,4).set(5,5).set(6,6))}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-grid-item"]],hostAttrs:[1,"p-5","border","border-1","flex","justify-center","items-center","h-full"],inputs:{currentRotation:[1,"currentRotation"],index:[1,"index"],toggleTrikot:[1,"toggleTrikot"],roatedPlayer:[1,"roatedPlayer"]},standalone:!0,features:[w],decls:8,vars:4,consts:[[1,"flex","flex-col","justify-center","items-center","gap-2"],[1,"bg-neutral","rounded-box","text-neutral-content","flex","flex-col","p-2"],[1,"countdown","font-league","text-5xl","text-center","text-primary"],[1,"swap","font-league","uppercase"]],template:function(t,n){if(t&1&&(r(0,"div",0),et(1)(2),r(3,"div",1)(4,"span",2),v(5,"span"),o()(),r(6,"label",3),h(7),o()()),t&2){let c=n.rotationMap.get(n.currentRotation()),d=n.roatedPlayer().get(c.get(n.index()));a(5),D("--value:",n.toggleTrikot()?d==null?null:d.trikot:n.rotationIndexMap.get(n.index()),";"),a(2),E(" ",d==null?null:d.name," ")}},dependencies:[U],encapsulation:2});let s=i;return s})();var Xt=["rangeSlider"],jt=(s,i)=>[s,i];function zt(s,i){if(s&1&&(r(0,"mat-option",6),h(1),o()),s&2){let l=i.$implicit;u("value",l.id),a(),E(" ",l.title," ")}}function Ht(s,i){if(s&1){let l=L();r(0,"a",10),h(1),p(2,"transloco"),o(),r(3,"button",11),b("click",function(){x(l);let t=f();return y(t.copyLinkToClipboard())}),r(4,"mat-icon",12),h(5,"link"),o()()}if(s&2){let l=f();u("routerLink",it(4,jt,l.ROUTES.root+l.ROUTES.editGame,l.selectedEvent)),a(),T(m(2,2,"edit-this-event"))}}function Qt(s,i){s&1&&(r(0,"p"),h(1),p(2,"transloco"),o()),s&2&&(a(),T(m(2,1,"move-the-slider-preview-each-rotation-on-the-curt")))}function $t(s,i){if(s&1&&(r(0,"div",20)(1,"div",22)(2,"span",23),v(3,"span"),o()(),r(4,"label",24),h(5),o()()),s&2){let l=i.$implicit;a(3),D("--value:",l==null?null:l.trikot,";"),a(2),E(" ",l==null?null:l.name," ")}}function qt(s,i){if(s&1){let l=L();r(0,"div",8)(1,"h6",13),h(2),p(3,"transloco"),o(),r(4,"mat-slide-toggle",14,0)(6,"span",15),h(7),p(8,"transloco"),p(9,"transloco"),p(10,"transloco"),o()(),r(11,"div",16),v(12,"app-grid-item",17)(13,"app-grid-item",17)(14,"app-grid-item",17)(15,"app-grid-item",17)(16,"app-grid-item",17)(17,"app-grid-item",17),o(),r(18,"input",18,1),$("ngModelChange",function(t){x(l);let n=f();return Q(n.rotationSlider,t)||(n.rotationSlider=t),y(t)}),b("ngModelChange",function(t){x(l);let n=f();return y(n.onSliderChange(t))}),o(),S(20,Qt,3,3,"p"),v(21,"hr"),r(22,"h3"),h(23,"Bank"),o(),r(24,"div",19),A(25,$t,6,4,"div",20,V),o(),r(27,"h3"),h(28,"Notes"),o(),r(29,"textarea",21,2),b("change",function(){x(l);let t=j(30),n=f();return y(n.updateNotes(t))}),o()()}if(s&2){let l,e=j(5),t=f();a(2),z("",m(3,35,"setter"),": ",t.convertRoationCountToSetterPosition,""),a(2),u("checked",!0),a(3),z(" ",m(8,37,"show")," ",e.checked?m(9,39,"Trikotnumber"):m(10,41,"BasePosition"),""),a(5),u("currentRotation",t.slider)("index",1)("toggleTrikot",e.checked)("roatedPlayer",t.roatedPlayer),a(),u("currentRotation",t.slider)("index",2)("toggleTrikot",e.checked)("roatedPlayer",t.roatedPlayer),a(),u("currentRotation",t.slider)("index",3)("toggleTrikot",e.checked)("roatedPlayer",t.roatedPlayer),a(),u("currentRotation",t.slider)("index",4)("toggleTrikot",e.checked)("roatedPlayer",t.roatedPlayer),a(),u("currentRotation",t.slider)("index",5)("toggleTrikot",e.checked)("roatedPlayer",t.roatedPlayer),a(),u("currentRotation",t.slider)("index",6)("toggleTrikot",e.checked)("roatedPlayer",t.roatedPlayer),a(),O("tooltip",!t.hasMoved),H("ngModel",t.rotationSlider),a(2),M(t.hasMoved?-1:20),a(5),P(t.bank),a(4),u("value",t.event.notes||"")("disabled",t.event.owner!==((l=t.session())==null||l.user==null?null:l.user.id))}}function Gt(s,i){s&1&&(r(0,"div",9)(1,"mat-icon",25),h(2,"swipe_up"),o(),r(3,"p"),h(4),p(5,"transloco"),o()()),s&2&&(a(4),T(m(5,1,"please-select-an-event-to-see-information-here")))}var ei=(()=>{let i=class i{constructor(){this.ROUTES=N,this.router=_(B),this.snack=_(wt),this.meta=_(Ut),this.route=_(rt),this.eventService=_(Tt),this.playerService=_(bt),this.session=ct(ut.session),this.events=this.eventService.getEvents(),this.roatedPlayer=new Map,this.rotationSlider=1,this.hasMoved=!1,this.bank=[]}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}updateNotes(e){return g(this,null,function*(){try{yield this.eventService.createEvent(G(k({},this.event),{notes:e.value}))}catch{this.snack.open("Error saving Note","OK",{duration:2e3})}})}copyLinkToClipboard(){navigator.clipboard.writeText(document.location.href),this.snack.open("Copy to clipboard")}get slider(){return String(this.rotationSlider)}get convertRoationCountToSetterPosition(){switch(this.rotationSlider){case 1:return 1;case 2:return 6;case 3:return 5;case 4:return 4;case 5:return 3;case 6:return 2}return 0}ngOnInit(){return g(this,null,function*(){this.route.queryParams.subscribe(e=>{let t=e.rotation;t&&(this.rotationSlider=+t,this.hasMoved=!0,this.updateRouteWithRotation())}),this.route.data.subscribe(e=>g(this,null,function*(){this.event=e.game,this.selectedEvent=this.event?.id,yield this.updateProps(),this.meta.updateMetadata({title:`${this.event?.title}-> Rotation Planer`,description:"Plan your rotation for your next game",type:"website"},!0)})),this.route.queryParams.subscribe(e=>{let t=e.rotation;t&&(this.rotationSlider=+t)}),this.sub=Z(4e3).pipe(Y(()=>!this.hasMoved)).subscribe(()=>{this.rotationSlider===6?this.rotationSlider=1:this.rotationSlider+=1,this.updateRouteWithRotation()})})}onSliderChange(e){this.rotationSlider=e,this.hasMoved=!0,this.updateRouteWithRotation()}updateRouteWithRotation(){this.router.navigate([],{relativeTo:this.route,queryParams:{rotation:this.rotationSlider},queryParamsHandling:"merge"})}updateProps(){return g(this,null,function*(){let e=new Map;if(!this.event)return;this.router.navigate([N.root+N.roationPlaner,this.event.id]);let t=Object.entries(this.event?.home_team_start_rotation),n=Object.values(Object.fromEntries(t)),c=yield this.playerService.getPlayerList([...t.map(d=>d[1]),...(0,C.without)(this.event.attendees,...n)]);t.forEach(([d,Nt])=>{e.set(Number(d),c.find(Ot=>Ot.id===Nt))}),this.roatedPlayer=e,this.bank=(0,C.without)(this.event.attendees,...n).map(d=>(0,C.find)(c,{id:d}))})}handleGameChange(e){return g(this,null,function*(){this.event=yield this.eventService.getEvent(e),this.updateProps()})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=I({type:i,selectors:[["app-rotation-planer"]],viewQuery:function(t,n){if(t&1&&W(Xt,5),t&2){let c;F(c=X())&&(n.rangeSlider=c.first)}},hostAttrs:[1,"w-full","flex","h-full"],standalone:!0,features:[w],decls:15,vars:8,consts:[["toggleTrikot",""],["rangeSlider",""],["notes",""],[1,"flex","flex-col","w-full","h-full","p-5","justify-center","gap-8"],[1,"flex","flex-col"],["placeholder","Select Game",3,"ngModelChange","valueChange","ngModel"],[3,"value"],[1,"flex","justify-between"],[1,"flex","flex-col","justify-evenly","gap-4"],[1,"flex","flex-col","items-center"],[3,"routerLink"],[1,"btn","w-16","h-8",3,"click"],[1,"text-primary"],[1,"text-md"],[3,"checked"],[1,"!text-primary"],[1,"grid","grid-cols-3","gap-8","grid-rows-2","justify-center","border-2","p-8"],[3,"currentRotation","index","toggleTrikot","roatedPlayer"],["type","range","min","1","max","6","value","1","data-tip","move to stop auto-rotation",1,"tooltip","tooltip-open","tooltip-secondary",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-6","gap-2","grid-rows-1","justify-center"],[1,"flex","flex-col","justify-center","items-center","gap-2","border","border-1","p-3"],["placeholder","Bio",1,"textarea",2,"field-sizing","content",3,"change","value","disabled"],[1,"bg-neutral","rounded-box","text-neutral-content","flex","flex-col","p-2"],[1,"countdown","font-league","text-5xl","text-center","text-primary"],[1,"swap","font-league","uppercase"],[1,"!h-20"]],template:function(t,n){if(t&1&&(r(0,"div",3)(1,"div",4)(2,"mat-form-field")(3,"mat-label"),h(4),p(5,"transloco"),o(),r(6,"mat-select",5),$("ngModelChange",function(d){return Q(n.selectedEvent,d)||(n.selectedEvent=d),d}),b("valueChange",function(d){return n.handleGameChange(d)}),A(7,zt,2,2,"mat-option",6,V),p(9,"async"),o()(),r(10,"div",7),S(11,Ht,6,7),o()(),v(12,"hr"),S(13,qt,31,43,"div",8)(14,Gt,6,3,"div",9),o()),t&2){let c;a(4),T(m(5,4,"event")),a(2),H("ngModel",n.selectedEvent),a(),P(m(9,6,n.events)),a(4),M(((c=n.session())==null||c.user==null?null:c.user.id)===(n.event==null?null:n.event.owner)?11:-1),a(2),M(n.event?13:14)}},dependencies:[U,st,ft,_t,vt,pt,mt,lt,ot,gt,Et,Mt,St,Vt,Ct,xt,Dt,Pt,At,Rt,yt,Bt,ht,dt],encapsulation:2});let s=i;return s})();export{ei as RotationPlanerPageComponent};
