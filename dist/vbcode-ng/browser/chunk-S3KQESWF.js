import{a as Le}from"./chunk-T4ZNPVC2.js";import{b as Be}from"./chunk-HSIPPX3X.js";import{a as Pe}from"./chunk-JZ2GM4SD.js";import{a as Ie}from"./chunk-YD5EW25E.js";import{a as $,b as j}from"./chunk-NDCLUC4R.js";import{a as Ge,b as Me}from"./chunk-UJWD5TW6.js";import{a as D,b as Te,e as U,f as q}from"./chunk-CL4REFVJ.js";import{b as ve,d as k,f as R,g as _e,h as Q,j as s,l as he,m as ye,o as xe,p as Ce,q as Se,r as we,t as N,u as V}from"./chunk-LSGJARMQ.js";import"./chunk-3ACIU7HM.js";import{d as be}from"./chunk-22WJ2TVG.js";import{b as se,c as ce}from"./chunk-Z5LCR3JO.js";import{a as ue}from"./chunk-ZNAIGONW.js";import{a as Ee}from"./chunk-VPMAAHZC.js";import{V as A,a as Fe}from"./chunk-IGCTOUO2.js";import{C as fe,D as ge,i as re,k as me,l as le,p as pe,y as de}from"./chunk-GTPAEQNT.js";import{Ac as te,Bc as ie,Da as H,Ea as z,Eb as u,Jb as C,Kb as S,Mb as w,Nb as g,Ob as a,Pa as T,Pb as n,Qb as v,Rc as ne,Sb as X,Vb as K,Xb as G,ec as B,ed as ae,gc as m,hc as f,ib as i,ic as h,jc as Y,kd as oe,na as y,oc as Z,sc as L,ta as I,tc as O,vc as J,wa as P,wc as ee,yc as c,zb as x,zc as d}from"./chunk-EGQDYXLC.js";import"./chunk-SECEFDB3.js";import{i as M}from"./chunk-GK2WYAVW.js";var Oe=(()=>{let t=class t{transform(o,l){return o?o.filter(p=>p.id!==l):null}};t.\u0275fac=function(l){return new(l||t)},t.\u0275pipe=P({name:"pristineEvent",type:t,pure:!0,standalone:!0});let e=t;return e})();var ke=(()=>{let t=class t{transform(o,l,p){if(!o)return[];let _=Object.values(l).map(b=>b.value),E=o.filter(b=>!_.includes(b?.id))||[],F=o.find(b=>b?.id===l[p].value);return[...E,F]}};t.\u0275fac=function(l){return new(l||t)},t.\u0275pipe=P({name:"pristine",type:t,pure:!1,standalone:!0});let e=t;return e})();function $e(e,t){if(e&1&&(a(0,"mat-option",1),m(1),n()),e&2){let r=t.$implicit;u("value",r==null?null:r.id),i(),Y(" ",r==null?null:r.trikot," - ",r==null?null:r.name," ")}}var Re=(()=>{let t=class t{constructor(){this.index=T.required(),this.home_team_start_rotation=T.required(),this.playerList=T.required(),this.attendees=T.required(),this.attendeesPlayer=ne(()=>this.attendees()?.map(o=>this.playerList().find(l=>l.id===o)))}};t.\u0275fac=function(l){return new(l||t)},t.\u0275cmp=I({type:t,selectors:[["app-single-roation-form-control"]],hostAttrs:[1,"flex","flex-col"],inputs:{index:[1,"index"],home_team_start_rotation:[1,"home_team_start_rotation"],playerList:[1,"playerList"],attendees:[1,"attendees"]},standalone:!0,features:[L],decls:8,vars:6,consts:[[3,"formControl"],[3,"value"]],template:function(l,p){if(l&1&&(a(0,"mat-form-field")(1,"mat-label"),m(2),n(),Z(3),a(4,"mat-select",0),w(5,$e,2,3,"mat-option",1,S),c(7,"pristine"),n()()),l&2){i(2),f(p.index());let _=p.home_team_start_rotation().controls;i(2),u("formControl",_[p.index()]),i(),g(ie(7,2,p.attendeesPlayer(),_,p.index()))}},dependencies:[q,U,D,j,$,A,N,R,V,xe,ke],encapsulation:2});let e=t;return e})();var je=()=>["Private","Public"],Ne=(e,t)=>[e,t],Ve=()=>[4,3,2,5,6,1],He=(e,t,r)=>[e,t,r];function ze(e,t){e&1&&(m(0),c(1,"transloco")),e&2&&h(" ",d(1,1,"create-a-new-game")," ")}function Ke(e,t){e&1&&(m(0),c(1,"transloco")),e&2&&h(" ",d(1,1,"edit-a-game")," ")}function Je(e,t){if(e&1&&(a(0,"mat-option",17),m(1),n()),e&2){let r=t.$implicit;u("value",r),i(),h(" ",r," ")}}function Qe(e,t){if(e&1&&(a(0,"mat-option",17),m(1),n()),e&2){let r=t.$implicit;u("value",r.id),i(),h(" ",r.name," ")}}function We(e,t){if(e&1&&v(0,"app-attendees-select-form-control",19),e&2){let r=G();u("playerList",r.playerList)("attendees",r.createGameForm.controls.attendees)}}function Xe(e,t){if(e&1&&v(0,"app-single-roation-form-control",32),e&2){let r=t.$implicit,o=G(2);u("playerList",o.playerList)("index",r)("attendees",o.createGameForm.controls.attendees.value)("home_team_start_rotation",o.createGameForm.controls.home_team_start_rotation)}}function Ye(e,t){e&1&&(a(0,"span",30),m(1),c(2,"transloco"),n(),a(3,"p"),m(4,"Bezieht sich nur auf Satz 1 solange diese noch nicht Satzweise abgepasst werden kann"),n(),a(5,"div",31),w(6,Xe,1,4,"app-single-roation-form-control",32,S),n()),e&2&&(i(),f(d(2,1,"start-rotation")),i(5),g(O(3,Ve)))}function Ze(e,t){if(e&1&&(a(0,"mat-option",17),m(1),n()),e&2){let r=t.$implicit;u("value",r.id),i(),h(" ",r.name," ")}}function et(e,t){if(e&1&&v(0,"app-single-roation-form-control",33),e&2){let r=t.$implicit,o=G(2);u("playerList",o.playerList)("attendees",o.createGameForm.controls.attendees.value)("index",r)("home_team_start_rotation",o.createGameForm.controls.away_team_start_rotation)}}function tt(e,t){e&1&&(a(0,"span",30),m(1),c(2,"transloco"),n(),a(3,"div",31),w(4,et,1,4,"app-single-roation-form-control",33,S),n()),e&2&&(i(),f(d(2,1,"start-rotation")),i(3),g(O(3,Ve)))}function it(e,t){e&1&&(a(0,"div",26)(1,"div",13)(2,"mat-form-field",7)(3,"mat-label"),m(4),c(5,"transloco"),n(),v(6,"input",34),n()(),a(7,"div",13)(8,"mat-form-field",7)(9,"mat-label"),m(10),c(11,"transloco"),n(),v(12,"input",35),n()()()),e&2&&(i(4),h("",d(5,2,"result-home")," "),i(6),h("",d(11,4,"result-away")," "))}function nt(e,t){if(e&1&&(a(0,"a",29),m(1),c(2,"transloco"),n()),e&2){let r=G();u("routerLink",ee(4,He,r.ROUTES.root,r.ROUTES.roationPlaner,r.createGameForm.controls.id.value)),i(),f(d(2,2,"See Rotation Preview"))}}var qt=(()=>{let t=class t{constructor(){this.ROUTES=ue,this.route=y(re),this.router=y(me),this.snack=y(Ie),this.eventsService=y(Ee),this.supabase=y(ge),this.playerService=y(Fe),this.teamService=y(Pe),this.session=de(fe.session),this.teams=[],this.players=this.playerService.getPlayers(),this.playerList=[],this.createGameForm=new Q({id:new s(void 0),title:new s("",k.required),date:new s(new Date,k.required),attendees:new s([]),result_home:new s(void 0),result_away:new s(void 0),home_team:new s(void 0),home_team_start_rotation:new Q({1:new s(null),2:new s(null),3:new s(null),4:new s(null),5:new s(null),6:new s(null)}),away_team_start_rotation:new we([new s(null),new s(null),new s(null),new s(null),new s(null),new s(null)]),away_team:new s(void 0),owner:new s(this.session().user.id,k.required),shared_with:new s([]),visibility:new s("Private")})}createGame(){return M(this,null,function*(){let o=this.createGameForm.value;try{yield this.eventsService.createEvent(o),this.snack.open("Event create","open",{duration:5e3}).onAction().subscribe(()=>{})}catch(l){this.snack.open("Error creating Event:"+l,"OK",{duration:2e3})}})}OnHomeTeamChange(o){return M(this,null,function*(){if(!o)return;let l=yield this.teamService.getTeam(o);this.playerList=yield this.playerService.getPlayerList(l.players)})}ngOnInit(){return M(this,null,function*(){this.route.data.subscribe(o=>{o.game&&this.createGameForm.patchValue(o.game),this.OnHomeTeamChange(this.createGameForm.controls.home_team.value)}),this.teams=yield this.teamService.getTeams()})}};t.\u0275fac=function(l){return new(l||t)},t.\u0275cmp=I({type:t,selectors:[["app-create-game-page"]],standalone:!0,features:[L],decls:70,vars:52,consts:[["form",""],["homeTeam",""],["awayTeam",""],["eventFinished",""],[1,"flex","flex-col","items-start","gap-8","h-full","p-8"],[1,"text-2xl","font-bold"],[1,"flex","flex-col","w-full",3,"submit","formGroup"],[1,"w-full"],["matInput","","formControlName","title"],[1,"flex","justify-between"],[1,"w-1/3"],["formControlName","visibility"],[3,"value",4,"ngFor","ngForOf"],[1,"w-1/2"],["matInput","","type","date","formControlName","date"],[1,"text-lg"],["formControlName","home_team",3,"valueChange"],[3,"value"],[3,"routerLink"],[3,"playerList","attendees"],[1,"my-2"],[1,""],["formControlName","away_team"],[1,"label","cursor-pointer"],[1,"label-text"],["type","checkbox",1,"toggle"],[1,"flex","gap-2","w-full"],[1,"btn",3,"type"],[1,"flex","flex-col","gap-2"],[1,"btn","btn-outline","btn-secondary",3,"routerLink"],[1,"text-md"],[1,"grid","grid-cols-3"],[3,"playerList","index","attendees","home_team_start_rotation"],[3,"playerList","attendees","index","home_team_start_rotation"],["matInput","","type","number","formControlName","result_home"],["matInput","","type","number","formControlName","result_away"]],template:function(l,p){if(l&1){let _=X();a(0,"div",4)(1,"span",5),x(2,ze,2,3)(3,Ke,2,3),n(),a(4,"form",6,0),K("submit",function(){return H(_),z(p.createGame())}),a(6,"mat-form-field",7)(7,"mat-label"),m(8),c(9,"transloco"),n(),v(10,"input",8),n(),a(11,"div",9)(12,"mat-form-field",10)(13,"mat-label"),m(14),c(15,"transloco"),n(),a(16,"mat-select",11),x(17,Je,2,2,"mat-option",12),n()(),a(18,"mat-form-field",13)(19,"mat-label"),m(20),c(21,"transloco"),n(),v(22,"input",14),n()(),v(23,"hr"),a(24,"span",15),m(25),c(26,"transloco"),n(),a(27,"mat-form-field",7)(28,"mat-label"),m(29),c(30,"transloco"),n(),a(31,"mat-select",16,1),K("valueChange",function(F){return H(_),z(p.OnHomeTeamChange(F))}),w(33,Qe,2,2,"mat-option",17,S),n(),a(35,"mat-hint")(36,"a",18),m(37),c(38,"transloco"),n()()(),x(39,We,1,2,"app-attendees-select-form-control",19)(40,Ye,8,4),v(41,"hr",20),a(42,"div",21)(43,"mat-form-field",7)(44,"mat-label"),m(45),c(46,"transloco"),n(),a(47,"mat-select",22,2),w(49,Ze,2,2,"mat-option",17,S),c(51,"pristineEvent"),n()(),x(52,tt,6,4),n(),a(53,"label",23)(54,"span",24),m(55),c(56,"transloco"),n(),v(57,"input",25,3),n(),m(59),x(60,it,13,6,"div",26),a(61,"button",27),m(62),c(63,"transloco"),n()(),v(64,"hr"),a(65,"p",28)(66,"a",29),m(67),c(68,"transloco"),n(),x(69,nt,3,8,"a",29),n()()}if(l&2){let _=B(32),E=B(48),F=B(58);i(2),C(p.createGameForm.controls.id.value?3:2),i(2),u("formGroup",p.createGameForm),i(4),f(d(9,22,"title")),i(6),f(d(15,24,"visibility")),i(3),u("ngForOf",O(45,je)),i(3),f(d(21,26,"date")),i(5),f(d(26,28,"home")),i(4),f(d(30,30,"home-team")),i(4),g(p.teams),i(3),u("routerLink",J(46,Ne,p.ROUTES.root+p.ROUTES.teams,_.value)),i(),h(" ",d(38,32,"edit-this-team")," "),i(2),C(p.createGameForm.controls.home_team.valid?39:-1),i(),C(_.value?40:-1),i(5),f(d(46,34,"away-team")),i(4),g(te(51,36,p.teams,_.value)),i(3),C(E.value?52:-1),i(3),f(d(56,39,"event-finished")),i(4),h(" ",F.value," "),i(),C(F.checked||p.createGameForm.controls.result_home.value||p.createGameForm.controls.result_away.value?60:-1),i(),u("type","submit"),i(),f(d(63,41,"submit")),i(4),u("routerLink",J(49,Ne,p.ROUTES.root,p.ROUTES.games)),i(),f(d(68,43,"see-all-your-games-here")),i(2),C(p.createGameForm.controls.id.value?69:-1)}},dependencies:[q,U,D,Te,be,Me,Ge,N,he,ve,ye,R,_e,V,Ce,Se,Be,j,$,A,oe,ae,pe,le,ce,se,Re,Oe,Le],encapsulation:2});let e=t;return e})();export{qt as CreateGamePageComponent};
